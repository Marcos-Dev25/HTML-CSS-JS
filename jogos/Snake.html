<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game JS</title>
    <style>
        body {
    background-color: #333;
    color: #fff;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
}

.container {
    text-align: center;
}

#gameCanvas {
    background-color: #000;
    border: 5px solid #00f; /* Borda visível */
    display: block;
}

.info {
    font-size: 24px;
    margin-bottom: 10px;
}

#game-message {
    margin-top: 15px;
    font-size: 18px;
    font-weight: bold;
    color: #ff0;
}
    </style>
</head>
<body>
    <div class="container">
        <h1>Snake Game</h1>
        <div class="info">
            Pontuação: <span id="score">0</span>
        </div>
        
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        
        <div id="game-message">
            Use as setas para jogar! Clique ou pressione ESC para começar.
        </div>
    </div>
    
    <script>// ===============================================
// CONFIGURAÇÃO DO CANVAS E VARIÁVEIS GLOBAIS
// ===============================================
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const TILE_SIZE = 20; // Tamanho de cada bloco (20x20 pixels)
const GRID_SIZE = canvas.width / TILE_SIZE; // 400 / 20 = 20 blocos

let snake;
let food;
let dx = 0; // Direção X (-1, 0, 1)
let dy = 0; // Direção Y (-1, 0, 1)
let score = 0;
let gameLoopInterval;
let gameSpeed = 150; // Velocidade inicial (ms por frame)
let gameActive = false;

// Elementos de exibição
const scoreElement = document.getElementById('score');
const messageElement = document.getElementById('game-message');

// ===============================================
// FUNÇÕES DE INICIALIZAÇÃO
// ===============================================

/**
 * Inicializa a cobra e a comida para um novo jogo.
 */
function initGame() {
    // Cobra começa no centro e tem 3 blocos
    snake = [
        { x: Math.floor(GRID_SIZE / 2), y: Math.floor(GRID_SIZE / 2) },
        { x: Math.floor(GRID_SIZE / 2), y: Math.floor(GRID_SIZE / 2) + 1 },
        { x: Math.floor(GRID_SIZE / 2), y: Math.floor(GRID_SIZE / 2) + 2 }
    ];
    
    // Direção inicial: Subindo (para cima)
    dx = 0;
    dy = -1;
    score = 0;
    gameSpeed = 150;
    scoreElement.textContent = score;
    
    generateFood();
    gameActive = true;
    messageElement.textContent = 'Use as setas para jogar!';
    
    // Inicia o loop do jogo
    if (gameLoopInterval) clearInterval(gameLoopInterval);
    gameLoopInterval = setInterval(gameLoop, gameSpeed);
}

/**
 * Gera a comida em uma posição aleatória que não esteja ocupada pela cobra.
 */
function generateFood() {
    let newFood;
    do {
        // Gera coordenadas aleatórias dentro da grade
        newFood = {
            x: Math.floor(Math.random() * GRID_SIZE),
            y: Math.floor(Math.random() * GRID_SIZE)
        };
    } while (isSnakeCollision(newFood.x, newFood.y)); // Repete se a comida caiu na cobra

    food = newFood;
}

// ===============================================
// FUNÇÕES DE DESENHO (RENDERIZAÇÃO)
// ===============================================

/**
 * Desenha um bloco na grade nas coordenadas (x, y) com a cor especificada.
 */
function drawTile(x, y, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);
    
    // Opcional: Adicionar uma borda para melhor visualização dos blocos
    ctx.strokeStyle = '#000';
    ctx.strokeRect(x * TILE_SIZE, y * TILE_SIZE, TILE_SIZE, TILE_SIZE);
}

/**
 * Desenha todos os elementos do jogo: Cobra e Comida.
 */
function draw() {
    // Limpa a tela
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Desenha a Cobra
    snake.forEach((segment, index) => {
        const color = (index === 0) ? '#0f0' : '#0c0'; // Cabeça verde brilhante, corpo mais escuro
        drawTile(segment.x, segment.y, color);
    });

    // Desenha a Comida
    drawTile(food.x, food.y, 'red');
}

// ===============================================
// FUNÇÕES DE LÓGICA DO JOGO
// ===============================================

/**
 * Move a cobra um bloco na direção atual e verifica colisões.
 */
function moveSnake() {
    // Calcula a nova posição da cabeça
    const newHead = { x: snake[0].x + dx, y: snake[0].y + dy };

    // 1. Colisão com Paredes ou Auto-Colisão
    if (newHead.x < 0 || newHead.x >= GRID_SIZE || 
        newHead.y < 0 || newHead.y >= GRID_SIZE || 
        isSnakeCollision(newHead.x, newHead.y)) {
        
        gameOver();
        return;
    }

    // Adiciona a nova cabeça na frente
    snake.unshift(newHead);

    // 2. Colisão com Comida
    if (newHead.x === food.x && newHead.y === food.y) {
        score += 10;
        scoreElement.textContent = score;
        generateFood(); // Gera nova comida
        // A cobra não perde a cauda (cresce)
        
        // Acelera o jogo a cada 50 pontos
        if (score % 50 === 0 && gameSpeed > 50) {
            gameSpeed -= 10;
            clearInterval(gameLoopInterval);
            gameLoopInterval = setInterval(gameLoop, gameSpeed);
        }
        
    } else {
        // A cobra se move: remove a cauda
        snake.pop();
    }
}

/**
 * Verifica se uma coordenada (x, y) colide com o corpo da cobra.
 */
function isSnakeCollision(x, y) {
    // Começa do índice 1 para ignorar a própria cabeça (ao verificar a auto-colisão)
    for (let i = 1; i < snake.length; i++) {
        if (snake[i].x === x && snake[i].y === y) {
            return true;
        }
    }
    return false;
}

/**
 * Termina o jogo.
 */
function gameOver() {
    gameActive = false;
    clearInterval(gameLoopInterval);
    messageElement.textContent = `FIM DE JOGO! Pontuação Final: ${score}. Pressione ESC para recomeçar.`;
}

/**
 * Loop principal do jogo.
 */
function gameLoop() {
    if (!gameActive) return;
    
    moveSnake();
    draw();
}

// ===============================================
// CONTROLE DE TECLADO
// ===============================================

document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' || !gameActive && (e.key === 'ArrowUp' || e.key === 'ArrowDown' || e.key === 'ArrowLeft' || e.key === 'ArrowRight')) {
        initGame(); // Inicia/Reinicia o jogo
        return;
    }
    
    if (!gameActive) return;

    let newDx = dx;
    let newDy = dy;
    
    switch (e.key) {
        case 'ArrowUp':
            newDx = 0; newDy = -1;
            break;
        case 'ArrowDown':
            newDx = 0; newDy = 1;
            break;
        case 'ArrowLeft':
            newDx = -1; newDy = 0;
            break;
        case 'ArrowRight':
            newDx = 1; newDy = 0;
            break;
        default:
            return;
    }

    // Impede que a cobra dê meia-volta imediatamente
    if (newDx !== -dx || newDy !== -dy) {
        dx = newDx;
        dy = newDy;
    }
    
    e.preventDefault(); // Impede o scroll da página
});

// ===============================================
// INÍCIO
// ===============================================
// Desenha a tela inicial (antes de iniciar o primeiro jogo)
initGame(); 
gameOver(); // Coloca o jogo no estado "pronto para começar"</script>
</body>
</html>